{{ define "main" }}
<main>
	<article>
		<h2 class="page-title">{{ .Title }}</h2>
		<ul class="masonry">
		{{- $category := index .Site.Taxonomies.categories (lower "Photos") -}}
		{{- $list := $category.Pages -}}
		{{- $len := (len $list) -}}

		{{ $paginator := $index (where .Site.Pages.ByDate.Reverse "Type" "post") (index .Site.Params "archive-paginate" | default 18) }}
        {{ range $paginator.Pages  }}

		{{ range $index, $value := $list }}
		{{- .Scratch.Set "include_photo" true -}}

		{{- if and .Site.Params.photos_only_microblog (ne .Title "") -}}
			{{- .Scratch.Set "include_photo" false -}}
		{{- end -}}
		
		{{- if .Scratch.Get "include_photo" -}}
		{{- if .Params.photos -}}
			<li>
				<a href="{{ .Permalink }}">
					{{ range first 1 .Params.photos }}
						<img src="{{ . }}" loading="eager" />
					{{ end }}
				</a>
			</li>
		{{- end -}}
		{{- end -}}
		{{ end }}
		</ul>
	</article>
	{{ if or ($paginator.HasNext) ($paginator.HasPrev) }}
        <nav class="main-nav">
            <ul>
                <li>{{ if $paginator.HasNext }}<a href="{{ $paginator.Next.URL }}">← Older</a>{{ end }}</li>
                <li>{{ if $paginator.HasPrev }}<a href="{{ $paginator.Prev.URL }}">Newer →</a>{{ end }}</li>
            </ul>
        </nav>
    {{ end }}
</main>
{{ end }}